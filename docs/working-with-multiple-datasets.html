<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Working with multiple datasets | Working with Census Data in R</title>
  <meta name="description" content="9 Working with multiple datasets | Working with Census Data in R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Working with multiple datasets | Working with Census Data in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Working with multiple datasets | Working with Census Data in R" />
  
  
  

<meta name="author" content="Aditya Ranganath" />


<meta name="date" content="2022-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-data-retrieval.html"/>
<link rel="next" href="exporting-r-objects.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Census Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>2</b> Preliminaries</a></li>
<li class="part"><span><b>I Decennial Census</b></span></li>
<li class="chapter" data-level="3" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html"><i class="fa fa-check"></i><b>3</b> Basic Data Retrieval</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#load-table-of-variables"><i class="fa fa-check"></i><b>3.1</b> Load table of variables</a></li>
<li class="chapter" data-level="3.2" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#query-the-census-api-and-retrieve-data-using-tidycensus"><i class="fa fa-check"></i><b>3.2</b> Query the census API, and retrieve data using tidycensus</a></li>
<li class="chapter" data-level="3.3" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#modify-a-census-api-call-by-altering-arguments-to-the-get_decennial-function"><i class="fa fa-check"></i><b>3.3</b> Modify a census API call by altering arguments to the “get_decennial” function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>4</b> Basic data cleaning and manipulation with <em>dplyr</em></a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#renaming-and-deleting-columns"><i class="fa fa-check"></i><b>4.1</b> Renaming and deleting columns</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-rename-and-select-functions"><i class="fa fa-check"></i><b>4.1.1</b> The <code>rename</code> and <code>select</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#modifying-columns"><i class="fa fa-check"></i><b>4.2</b> Modifying columns</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#columns-and-string-operations"><i class="fa fa-check"></i><b>4.2.1</b> Columns and string operations</a></li>
<li class="chapter" data-level="4.2.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-relocate-function"><i class="fa fa-check"></i><b>4.2.2</b> The <code>relocate</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#subsetting-data"><i class="fa fa-check"></i><b>4.3</b> Subsetting Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-filter-function"><i class="fa fa-check"></i><b>4.3.1</b> The <code>filter</code> function</a></li>
<li class="chapter" data-level="4.3.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#slice-functions"><i class="fa fa-check"></i><b>4.3.2</b> <code>slice</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#creating-new-variables"><i class="fa fa-check"></i><b>4.4</b> Creating new variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="grouping-operations-and-summary-statistics.html"><a href="grouping-operations-and-summary-statistics.html"><i class="fa fa-check"></i><b>5</b> Grouping operations and summary statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="grouping-operations-and-summary-statistics.html"><a href="grouping-operations-and-summary-statistics.html#aggregate-summary-statistics"><i class="fa fa-check"></i><b>5.1</b> Aggregate summary statistics</a></li>
<li class="chapter" data-level="5.2" data-path="grouping-operations-and-summary-statistics.html"><a href="grouping-operations-and-summary-statistics.html#summary-statistics-by-group"><i class="fa fa-check"></i><b>5.2</b> Summary statistics by group</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="elementary-visualization.html"><a href="elementary-visualization.html"><i class="fa fa-check"></i><b>6</b> Elementary Visualization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="elementary-visualization.html"><a href="elementary-visualization.html#census-data-visualization-with-ggplot"><i class="fa fa-check"></i><b>6.1</b> Census data visualization with <em>ggplot</em></a></li>
<li class="chapter" data-level="6.2" data-path="elementary-visualization.html"><a href="elementary-visualization.html#spatial-visualization-with-tmap"><i class="fa fa-check"></i><b>6.2</b> Spatial visualization with <em>tmap</em></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html"><i class="fa fa-check"></i><b>7</b> Functions and Iteration</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#automate-creation-of-county-level-median-age-graphs"><i class="fa fa-check"></i><b>7.1</b> Automate creation of county-level median age graphs</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#write-county-level-median-age-graph-function"><i class="fa fa-check"></i><b>7.1.1</b> Write county-level median age graph function</a></li>
<li class="chapter" data-level="7.1.2" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#iteratively-apply-median_age_graph-function-to-multiple-input-elements"><i class="fa fa-check"></i><b>7.1.2</b> Iteratively apply <code>median_age_graph</code> function to multiple input elements</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#automate-creation-of-median-age-maps"><i class="fa fa-check"></i><b>7.2</b> Automate creation of median-age maps</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#write-function-to-create-county-level-median-age-maps"><i class="fa fa-check"></i><b>7.2.1</b> Write function to create county-level median age maps</a></li>
<li class="chapter" data-level="7.2.2" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#iteratively-apply-median_age_map-function-to-multiple-input-elements"><i class="fa fa-check"></i><b>7.2.2</b> Iteratively apply <code>median_age_map</code> function to multiple input elements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html"><i class="fa fa-check"></i><b>8</b> Advanced data retrieval</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-data-from-multiple-census-years"><i class="fa fa-check"></i><b>8.1</b> Retrieving data from multiple census years</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-different-census-year-datasets-and-placing-them-as-separate-elements-in-a-list"><i class="fa fa-check"></i><b>8.1.1</b> Retrieving different census year datasets and placing them as separate elements in a list</a></li>
<li class="chapter" data-level="8.1.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-different-census-year-datasets-and-placing-them-in-a-single-data-frame"><i class="fa fa-check"></i><b>8.1.2</b> Retrieving different census year datasets and placing them in a single data frame</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-data-from-multiple-states"><i class="fa fa-check"></i><b>8.2</b> Retrieving microgeography data from multiple states</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-datasets-for-multiple-states-and-placing-datasets-into-a-list"><i class="fa fa-check"></i><b>8.2.1</b> Retrieving microgeography datasets for multiple states and placing datasets into a list</a></li>
<li class="chapter" data-level="8.2.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-data-from-multiple-states-and-placing-them-into-the-same-data-frame"><i class="fa fa-check"></i><b>8.2.2</b> Retrieving microgeography data from multiple states and placing them into the same data frame</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-data-from-multiple-states-and-multiple-years"><i class="fa fa-check"></i><b>8.3</b> Retrieving microgeography data from multiple states AND multiple years</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-data-from-multiple-years-for-multiple-states-and-placing-the-datasets-from-the-various-stateyear-combinations-into-a-list"><i class="fa fa-check"></i><b>8.3.1</b> Retrieving data from multiple years, for multiple states, and placing the datasets from the various state/year combinations into a list</a></li>
<li class="chapter" data-level="8.3.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-data-from-multiple-years-for-multiple-states-and-placing-all-of-the-data-into-a-single-data-frame"><i class="fa fa-check"></i><b>8.3.2</b> Retrieving data from multiple years, for multiple states, and placing all of the data into a single data frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="working-with-multiple-datasets.html"><a href="working-with-multiple-datasets.html"><i class="fa fa-check"></i><b>9</b> Working with multiple datasets</a></li>
<li class="chapter" data-level="10" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html"><i class="fa fa-check"></i><b>10</b> Exporting R Objects</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#writing-out-census-datasets-as-csv-files"><i class="fa fa-check"></i><b>10.1</b> Writing out census datasets as CSV files</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#write-out-multiple-census-datasets-stored-a-list-to-disk-in-csv-format"><i class="fa fa-check"></i><b>10.1.1</b> Write out multiple census datasets stored a list to disk (in CSV format)</a></li>
<li class="chapter" data-level="10.1.2" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#write-out-multiple-census-datasets-stored-as-separate-objects-to-disk-in-csv-format"><i class="fa fa-check"></i><b>10.1.2</b> Write out multiple census datasets stored as separate objects to disk (in CSV format)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#writing-out-other-objects-i.e.-maps-visualizations-etc.-to-disk"><i class="fa fa-check"></i><b>10.2</b> Writing out other objects (i.e. maps, visualizations etc.) to disk</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#using-plot-devices-to-write-out-multiple-visualizations-to-a-single-file"><i class="fa fa-check"></i><b>10.2.1</b> Using plot devices to write out multiple visualizations to a single file</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II American Community Survey (ACS)</b></span></li>
<li class="chapter" data-level="11" data-path="acs-data-retrieval.html"><a href="acs-data-retrieval.html"><i class="fa fa-check"></i><b>11</b> ACS Data Retrieval</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Working with Census Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-multiple-datasets" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Working with multiple datasets</h1>
<p>It is often useful to bring separate datasets together in order to carry out a given analytic task. For instance, one might want to compare change over time by bringing together census datasets from different years (though it’s worth noting that temporal analysis with census data can be tricky, and must be undertaken with caution, due to changes in calculation methods or geographic borders across different census years).</p>
<p>For example, let’s say we want to visualize the percentage point change in every state’s rural population share between 2000 and 2010. In other words, how did the percentage of each states rural population (with respect to its overall population) change across the first decade of the 2000s? Which states saw the greatest degree of rural depopulation, and which states saw the lowest degree of rural depopulation?</p>
<p>Let’s begin with the <code>population_rural_2000_2010_list</code> object that we created in the previous section. It’s a list that contains information on the percentage of each state’s population living in rural areas; the first list element contains information on states’ rural population share from the 2000 census, while the second contains analogous information from the 2010 census.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="working-with-multiple-datasets.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints contents of &quot;population_rural_2000_2010_list&quot;</span></span>
<span id="cb205-2"><a href="working-with-multiple-datasets.html#cb205-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list</span></code></pre></div>
<pre><code>## $`2000`
## # A tibble: 52 x 6
##    GEOID NAME                  P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama               4447100 1981427     44.6   2000
##  2 02    Alaska                 626932  215675     34.4   2000
##  3 04    Arizona               5130632  607097     11.8   2000
##  4 05    Arkansas              2673400 1269221     47.5   2000
##  5 06    California           33871648 1881985      5.56  2000
##  6 08    Colorado              4301261  668076     15.5   2000
##  7 09    Connecticut           3405565  417506     12.3   2000
##  8 10    Delaware               783600  155842     19.9   2000
##  9 11    District of Columbia   572059       0      0     2000
## 10 12    Florida              15982378 1712358     10.7   2000
## # … with 42 more rows
## 
## $`2010`
## # A tibble: 52 x 6
##    GEOID NAME         P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama      4779736 1957932     41.0   2010
##  2 02    Alaska        710231  241338     34.0   2010
##  3 04    Arizona      6392017  651358     10.2   2010
##  4 05    Arkansas     2915918 1278329     43.8   2010
##  5 06    California  37253956 1880350      5.05  2010
##  6 22    Louisiana    4533372 1215567     26.8   2010
##  7 21    Kentucky     4339367 1806024     41.6   2010
##  8 08    Colorado     5029196  696435     13.8   2010
##  9 09    Connecticut  3574097  429155     12.0   2010
## 10 10    Delaware      897934  149985     16.7   2010
## # … with 42 more rows</code></pre>
<p>In order to visualize the percentage point difference in state-level rural population shares between 2010 and 2000, we can join the two datasets in <code>population_rural_2000_2010_list</code>, compute the difference between “rural_pct” in the 2010 dataset and “rural_pct” in the 2000 dataset, and then use now-familiar visualization techniques to visualize this difference.</p>
<p>Before joining the two datasets, it might make sense to clean them up to avoid any confusion after we implement the join. First, it would be nice to rename the “rural_pct” variable in the two datasets to indicate the relevant year, i.e. in the form “rural_pct_YEAR” where YEAR takes on the value in the existing “year” column. After renaming the “rural_pct” variable in this way, we can go ahead and delete the “P001001”, “P002005”, and “year” columns, since they do not contain necessary information, and will simply clutter the final (joined) dataset.</p>
<p>To clean up the datasets in this way, let’s write a function that makes these changes, and use now-familiar iteration techniques to apply the changes to both of the list elements in <code>population_rural_2000_2010_list</code>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="working-with-multiple-datasets.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write function to clean dataset according to the requirements specified above and assign to an object named &quot;cleaning_function&quot; </span></span>
<span id="cb207-2"><a href="working-with-multiple-datasets.html#cb207-2" aria-hidden="true" tabindex="-1"></a>cleaning_function<span class="ot">&lt;-</span><span class="cf">function</span>(dataset){</span>
<span id="cb207-3"><a href="working-with-multiple-datasets.html#cb207-3" aria-hidden="true" tabindex="-1"></a>  year_vector<span class="ot">&lt;-</span>dataset<span class="sc">$</span>year <span class="co"># extracts the &quot;year&quot; column as a vector</span></span>
<span id="cb207-4"><a href="working-with-multiple-datasets.html#cb207-4" aria-hidden="true" tabindex="-1"></a>  year_extracted<span class="ot">&lt;-</span>year_vector[<span class="dv">1</span>] <span class="co"># plucks out the first element of &quot;year_vector&quot;</span></span>
<span id="cb207-5"><a href="working-with-multiple-datasets.html#cb207-5" aria-hidden="true" tabindex="-1"></a>  desired_name<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">&quot;rural_pct&quot;</span>, <span class="st">&quot;_&quot;</span>, year_extracted) <span class="co"># creates desired name string</span></span>
<span id="cb207-6"><a href="working-with-multiple-datasets.html#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(dataset)[<span class="dv">5</span>]<span class="ot">&lt;-</span>desired_name <span class="co"># renames &quot;rural_pct&quot; with &quot;desired_name&quot; </span></span>
<span id="cb207-7"><a href="working-with-multiple-datasets.html#cb207-7" aria-hidden="true" tabindex="-1"></a>  final<span class="ot">&lt;-</span>dataset <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(P001001, P002005, year)) <span class="co"># deletes specified columns</span></span>
<span id="cb207-8"><a href="working-with-multiple-datasets.html#cb207-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(final) <span class="co"># returns cleaned dataset</span></span>
<span id="cb207-9"><a href="working-with-multiple-datasets.html#cb207-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="working-with-multiple-datasets.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># applies &quot;cleaning_function&quot; to both of the list elements in ```population_rural_2000_2010_list``` and assigns the result to a new object named &quot;population_rural_2000_2010_list_cleaned&quot;</span></span>
<span id="cb208-2"><a href="working-with-multiple-datasets.html#cb208-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list_cleaned<span class="ot">&lt;-</span><span class="fu">map</span>(population_rural_2000_2010_list, cleaning_function)</span></code></pre></div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="working-with-multiple-datasets.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints contents of &quot;population_rural_2000_2010_list_cleaned&quot;</span></span>
<span id="cb209-2"><a href="working-with-multiple-datasets.html#cb209-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list_cleaned</span></code></pre></div>
<pre><code>## $`2000`
## # A tibble: 52 x 3
##    GEOID NAME                 rural_pct_2000
##    &lt;chr&gt; &lt;chr&gt;                         &lt;dbl&gt;
##  1 01    Alabama                       44.6 
##  2 02    Alaska                        34.4 
##  3 04    Arizona                       11.8 
##  4 05    Arkansas                      47.5 
##  5 06    California                     5.56
##  6 08    Colorado                      15.5 
##  7 09    Connecticut                   12.3 
##  8 10    Delaware                      19.9 
##  9 11    District of Columbia           0   
## 10 12    Florida                       10.7 
## # … with 42 more rows
## 
## $`2010`
## # A tibble: 52 x 3
##    GEOID NAME        rural_pct_2010
##    &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt;
##  1 01    Alabama              41.0 
##  2 02    Alaska               34.0 
##  3 04    Arizona              10.2 
##  4 05    Arkansas             43.8 
##  5 06    California            5.05
##  6 22    Louisiana            26.8 
##  7 21    Kentucky             41.6 
##  8 08    Colorado             13.8 
##  9 09    Connecticut          12.0 
## 10 10    Delaware             16.7 
## # … with 42 more rows</code></pre>
<p>Now, let’s merge these datasets together, using “GEOID” as the join variable:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="working-with-multiple-datasets.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Joins datasets in list and assigns joined dataset to object named &quot;rural_change&quot;</span></span>
<span id="cb211-2"><a href="working-with-multiple-datasets.html#cb211-2" aria-hidden="true" tabindex="-1"></a>rural_change<span class="ot">&lt;-</span><span class="fu">full_join</span>(population_rural_2000_2010_list_cleaned[[<span class="st">&quot;2010&quot;</span>]], population_rural_2000_2010_list_cleaned[[<span class="st">&quot;2000&quot;</span>]], <span class="at">by=</span><span class="st">&quot;GEOID&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="working-with-multiple-datasets.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cleans &quot;rural_change&quot; by deleting &quot;NAME.y&quot; and renaming &quot;NAME.x&quot;, and then creates new variable that captures the difference between &quot;rural_pct_2010&quot; and &quot;rural_pct_2000&quot;</span></span>
<span id="cb212-2"><a href="working-with-multiple-datasets.html#cb212-2" aria-hidden="true" tabindex="-1"></a>rural_change<span class="ot">&lt;-</span>rural_change <span class="sc">%&gt;%</span> </span>
<span id="cb212-3"><a href="working-with-multiple-datasets.html#cb212-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(<span class="sc">-</span>(NAME.y)) <span class="sc">%&gt;%</span> </span>
<span id="cb212-4"><a href="working-with-multiple-datasets.html#cb212-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rename</span>(<span class="at">NAME=</span>NAME.x) <span class="sc">%&gt;%</span> </span>
<span id="cb212-5"><a href="working-with-multiple-datasets.html#cb212-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">rural_share_change=</span>rural_pct_2010<span class="sc">-</span>rural_pct_2000)</span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="working-with-multiple-datasets.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prints modified &quot;rural_change&quot; object</span></span>
<span id="cb213-2"><a href="working-with-multiple-datasets.html#cb213-2" aria-hidden="true" tabindex="-1"></a>rural_change</span></code></pre></div>
<pre><code>## # A tibble: 52 x 5
##    GEOID NAME        rural_pct_2010 rural_pct_2000 rural_share_change
##    &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;
##  1 01    Alabama              41.0           44.6              -3.59 
##  2 02    Alaska               34.0           34.4              -0.421
##  3 04    Arizona              10.2           11.8              -1.64 
##  4 05    Arkansas             43.8           47.5              -3.64 
##  5 06    California            5.05           5.56             -0.509
##  6 22    Louisiana            26.8           27.4              -0.560
##  7 21    Kentucky             41.6           44.2              -2.62 
##  8 08    Colorado             13.8           15.5              -1.68 
##  9 09    Connecticut          12.0           12.3              -0.252
## 10 10    Delaware             16.7           19.9              -3.18 
## # … with 42 more rows</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-data-retrieval.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exporting-r-objects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aranganath24/R_Census/edit/master/08-multiple-datasets.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/aranganath24/R_Census/blob/master/08-multiple-datasets.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
