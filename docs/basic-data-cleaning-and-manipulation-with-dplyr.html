<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Basic data cleaning and manipulation with dplyr | Working with Census Data in R</title>
  <meta name="description" content="3 Basic data cleaning and manipulation with dplyr | Working with Census Data in R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Basic data cleaning and manipulation with dplyr | Working with Census Data in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Basic data cleaning and manipulation with dplyr | Working with Census Data in R" />
  
  
  

<meta name="author" content="Aditya Ranganath" />


<meta name="date" content="2022-01-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-data-retrieval.html"/>
<link rel="next" href="grouping-operations-and-summary-statistics.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Census Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="part"><span><b>I Decennial Census</b></span></li>
<li class="chapter" data-level="2" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html"><i class="fa fa-check"></i><b>2</b> Basic Data Retrieval</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#load-table-of-variables"><i class="fa fa-check"></i><b>2.1</b> Load table of variables</a></li>
<li class="chapter" data-level="2.2" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#query-the-census-api-and-retrieve-data-using-tidycensus"><i class="fa fa-check"></i><b>2.2</b> Query the census API, and retrieve data using tidycensus</a></li>
<li class="chapter" data-level="2.3" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#modify-a-census-api-call-by-altering-arguments-to-the-get_decennial-function"><i class="fa fa-check"></i><b>2.3</b> Modify a census API call by altering arguments to the “get_decennial” function</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>3</b> Basic data cleaning and manipulation with <em>dplyr</em></a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#renaming-and-deleting-columns"><i class="fa fa-check"></i><b>3.1</b> Renaming and deleting columns</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-rename-and-select-functions"><i class="fa fa-check"></i><b>3.1.1</b> The <code>rename</code> and <code>select</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#modifying-columns"><i class="fa fa-check"></i><b>3.2</b> Modifying columns</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#columns-and-string-operations"><i class="fa fa-check"></i><b>3.2.1</b> Columns and string operations</a></li>
<li class="chapter" data-level="3.2.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-relocate-function"><i class="fa fa-check"></i><b>3.2.2</b> The <code>relocate</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#subsetting-data"><i class="fa fa-check"></i><b>3.3</b> Subsetting Data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-filter-function"><i class="fa fa-check"></i><b>3.3.1</b> The <code>filter</code> function</a></li>
<li class="chapter" data-level="3.3.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#slice-functions"><i class="fa fa-check"></i><b>3.3.2</b> <code>slice</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#creating-new-variables"><i class="fa fa-check"></i><b>3.4</b> Creating new variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="grouping-operations-and-summary-statistics.html"><a href="grouping-operations-and-summary-statistics.html"><i class="fa fa-check"></i><b>4</b> Grouping operations and summary statistics</a></li>
<li class="chapter" data-level="5" data-path="elementary-visualization.html"><a href="elementary-visualization.html"><i class="fa fa-check"></i><b>5</b> Elementary Visualization</a></li>
<li class="chapter" data-level="6" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html"><i class="fa fa-check"></i><b>6</b> Advanced data retrieval</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Working with Census Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-data-cleaning-and-manipulation-with-dplyr" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Basic data cleaning and manipulation with <em>dplyr</em></h1>
<p>Once data has been pulled into R Studio via <em>tidycensus</em>, it’s possible to work with data using the entire suite of data analysis tools available through the <em>tidyverse</em>. Among other things, we can use <em>tidyverse</em> tools to clean up, modify, or explore the census datasets that we retrieve using <em>tidycensus</em>.</p>
<div id="renaming-and-deleting-columns" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Renaming and deleting columns</h2>
<div id="the-rename-and-select-functions" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> The <code>rename</code> and <code>select</code> functions</h3>
<p>Let’s clean up the dataset of Colorado’s 2010 population distribution with respect to counties that we just created in the previous section (<code>CO_county_population_2010</code>). As a reminder, the first few rows of that dataset look like this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_county_population_2010)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(CO_county_population_2010, <span class="at">n=</span><span class="dv">6</span>)) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">NAME</th>
<th align="left">variable</th>
<th align="right">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08023</td>
<td align="left">Costilla County, Colorado</td>
<td align="left">P001001</td>
<td align="right">3524</td>
</tr>
<tr class="even">
<td align="left">08025</td>
<td align="left">Crowley County, Colorado</td>
<td align="left">P001001</td>
<td align="right">5823</td>
</tr>
<tr class="odd">
<td align="left">08027</td>
<td align="left">Custer County, Colorado</td>
<td align="left">P001001</td>
<td align="right">4255</td>
</tr>
<tr class="even">
<td align="left">08029</td>
<td align="left">Delta County, Colorado</td>
<td align="left">P001001</td>
<td align="right">30952</td>
</tr>
<tr class="odd">
<td align="left">08031</td>
<td align="left">Denver County, Colorado</td>
<td align="left">P001001</td>
<td align="right">600158</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="left">Douglas County, Colorado</td>
<td align="left">P001001</td>
<td align="right">285465</td>
</tr>
</tbody>
</table>
<p>Let’s remove the “variable” field, and rename the “value” field as “Population”. We can perform these operations by using functions from the <em>dplyr</em> package, which is a part of the <em>tidyverse</em>. We can use the <code>select</code> function to remove the “variable” field, and the <code>rename</code> function to rename the name of the field containing the population data from “value” to “population”. We’ll use the pipe operator (<code>%&gt;%</code>) to chain together these functions, which allows us to perform both of these cleaning operations in one block of code; we’ll assign the revised dataset to a new object named <code>CO_county_population_2010_cleaned</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Takes &quot;CO_county_population_2010&quot;, deletes the &quot;variable&quot; column, renames the &quot;value&quot; column as &quot;population&quot;, and assigns this modified dataset to a new object names &quot;CO_county_population_2010_cleaned&quot;</span></span>
<span id="cb14-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb14-2" aria-hidden="true" tabindex="-1"></a>CO_county_population_2010_cleaned<span class="ot">&lt;-</span>CO_county_population_2010 <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb14-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">select</span>(<span class="sc">-</span>variable) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb14-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">rename</span>(<span class="at">population=</span>value)</span></code></pre></div>
<p>Let’s view the dataset to ensure that these changes have been implemented:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_county_population_2010_cleaned) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">NAME</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08023</td>
<td align="left">Costilla County, Colorado</td>
<td align="right">3524</td>
</tr>
<tr class="even">
<td align="left">08025</td>
<td align="left">Crowley County, Colorado</td>
<td align="right">5823</td>
</tr>
<tr class="odd">
<td align="left">08027</td>
<td align="left">Custer County, Colorado</td>
<td align="right">4255</td>
</tr>
<tr class="even">
<td align="left">08029</td>
<td align="left">Delta County, Colorado</td>
<td align="right">30952</td>
</tr>
<tr class="odd">
<td align="left">08031</td>
<td align="left">Denver County, Colorado</td>
<td align="right">600158</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="left">Douglas County, Colorado</td>
<td align="right">285465</td>
</tr>
</tbody>
</table>
<p>Note that the <code>select</code> function can either be used to directly <strong><em>delete</em></strong> columns from a dataset (if these columns are preceded by a <code>-</code>) or alternatively, to designate the columns to <strong><em>keep</em></strong> (which will delete the residual columns). So, for example, the following syntax would also effectively delete the variable column, and rename the value column:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Takes &quot;CO_county_population_2010&quot;, deletes the &quot;variable&quot; column (using slightly different syntax than above), renames the &quot;value&quot; column as &quot;population&quot;, and assigns this modified dataset to a new object names &quot;CO_county_population_2010_cleaned_alternate&quot;</span></span>
<span id="cb16-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb16-2" aria-hidden="true" tabindex="-1"></a>CO_county_population_2010_cleaned_alternate<span class="ot">&lt;-</span>CO_county_population_2010 <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">select</span>(GEOID, NAME, value) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb16-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">rename</span>(<span class="at">population=</span>value)</span></code></pre></div>
<p>Let’s check to make sure that <code>CO_county_population_cleaned_alternate</code> looks the same as <code>CO_county_population_cleaned</code> above:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_county_population_2010_cleaned_alternate) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">NAME</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08023</td>
<td align="left">Costilla County, Colorado</td>
<td align="right">3524</td>
</tr>
<tr class="even">
<td align="left">08025</td>
<td align="left">Crowley County, Colorado</td>
<td align="right">5823</td>
</tr>
<tr class="odd">
<td align="left">08027</td>
<td align="left">Custer County, Colorado</td>
<td align="right">4255</td>
</tr>
<tr class="even">
<td align="left">08029</td>
<td align="left">Delta County, Colorado</td>
<td align="right">30952</td>
</tr>
<tr class="odd">
<td align="left">08031</td>
<td align="left">Denver County, Colorado</td>
<td align="right">600158</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="left">Douglas County, Colorado</td>
<td align="right">285465</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="modifying-columns" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Modifying columns</h2>
<div id="columns-and-string-operations" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Columns and string operations</h3>
<p>Note that the “Name” column in our cleaned county-level dataset of the Colorado population contains names in the format “<County Name> County, Colorado”. What if we want to edit this, such that we replace the “NAME” column with a new column named “County”, which contains simply the name of the county (i.e. &lt;“County Name”&gt; instead of &lt;“County Name&gt; County, Colorado”&gt;)? To do so, we can use the <code>mutate</code> function to create a new column named “County”, and then populate this column with the string that results from removing “County, Colorado” from the “NAME” column; then, we can go ahead and remove the “NAME” column. Below, instead of assigning this modified dataset to a new object, we’ll simply assign it back to <code>CO_county_population_2010_cleaned</code>, which overwrites that object’s existing contents with these changes:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the &quot;CO_county_population_2010_cleaned&quot; dataset, create a new variable named &quot;County&quot; that takes the information in the &quot;NAME&quot; column and removes the part of the string that contains &quot;County, Colorado&quot;, and then remove the now superfluous &quot;NAME&quot; column</span></span>
<span id="cb18-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-3" aria-hidden="true" tabindex="-1"></a>CO_county_population_2010_cleaned<span class="ot">&lt;-</span>CO_county_population_2010_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">mutate</span>(<span class="at">County=</span><span class="fu">str_remove</span>(NAME, <span class="st">&quot; County, Colorado&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">select</span>(<span class="sc">-</span>NAME)</span>
<span id="cb18-6"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View &quot;CO_county_population_2010_cleaned&quot; (Note that only the first six records are printed in this guide)</span></span>
<span id="cb18-8"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_county_population_2010_cleaned)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="right">population</th>
<th align="left">County</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08023</td>
<td align="right">3524</td>
<td align="left">Costilla</td>
</tr>
<tr class="even">
<td align="left">08025</td>
<td align="right">5823</td>
<td align="left">Crowley</td>
</tr>
<tr class="odd">
<td align="left">08027</td>
<td align="right">4255</td>
<td align="left">Custer</td>
</tr>
<tr class="even">
<td align="left">08029</td>
<td align="right">30952</td>
<td align="left">Delta</td>
</tr>
<tr class="odd">
<td align="left">08031</td>
<td align="right">600158</td>
<td align="left">Denver</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="right">285465</td>
<td align="left">Douglas</td>
</tr>
</tbody>
</table>
</div>
<div id="the-relocate-function" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> The <code>relocate</code> function</h3>
<p>It’s worth noting that we can use the <code>relocate</code> function to reorder a dataset’s columns to our specifications. For example, note that currently, the population column is sandwiched between “GEOID” and “County”; what if we prefer that the “population” column is the last column in the dataset? We can change the column order using the <code>relocate</code> function, and specify the desired relative position of a given column using either the <code>.before</code> or <code>.after</code> argument:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb19-1" aria-hidden="true" tabindex="-1"></a>CO_county_population_2010_cleaned<span class="ot">&lt;-</span>CO_county_population_2010_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">relocate</span>(population, <span class="at">.after=</span>County)</span>
<span id="cb19-3"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_county_population_2010_cleaned)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">County</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08023</td>
<td align="left">Costilla</td>
<td align="right">3524</td>
</tr>
<tr class="even">
<td align="left">08025</td>
<td align="left">Crowley</td>
<td align="right">5823</td>
</tr>
<tr class="odd">
<td align="left">08027</td>
<td align="left">Custer</td>
<td align="right">4255</td>
</tr>
<tr class="even">
<td align="left">08029</td>
<td align="left">Delta</td>
<td align="right">30952</td>
</tr>
<tr class="odd">
<td align="left">08031</td>
<td align="left">Denver</td>
<td align="right">600158</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="left">Douglas</td>
<td align="right">285465</td>
</tr>
</tbody>
</table>
<p>Note that if neither the <code>.before</code> nor <code>.after</code> arguments are specified within the <code>relocate</code> function, the column that is passed to <code>relocate</code> will automatically be moved to the front of the dataset (i.e. it will be the first column).</p>
</div>
</div>
<div id="subsetting-data" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Subsetting Data</h2>
<div id="the-filter-function" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> The <code>filter</code> function</h3>
<p><em>dplyr</em> also allows us to easily subset census data retrieved from <em>tidycensus</em>. Let’s say, for example, that we want to select only those counties in <code>CO_county_population_2010_cleaned</code> that have a population greater than 100,000. To do so, we can specify this condition with the appropriate logical operator within the <code>filter</code> function. We’ll assign this subsetted data to a new object named <code>CO_large_counties</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb20-1" aria-hidden="true" tabindex="-1"></a>CO_large_counties<span class="ot">&lt;-</span>CO_county_population_2010_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb20-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">filter</span>(population<span class="sc">&gt;</span><span class="dv">100000</span>)</span></code></pre></div>
<p>Now, let’s view our newly created table of Colorado counties with a population of greater than 100,000:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_large_counties)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">County</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08031</td>
<td align="left">Denver</td>
<td align="right">600158</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="left">Douglas</td>
<td align="right">285465</td>
</tr>
<tr class="odd">
<td align="left">08041</td>
<td align="left">El Paso</td>
<td align="right">622263</td>
</tr>
<tr class="even">
<td align="left">08069</td>
<td align="left">Larimer</td>
<td align="right">299630</td>
</tr>
<tr class="odd">
<td align="left">08059</td>
<td align="left">Jefferson</td>
<td align="right">534543</td>
</tr>
<tr class="even">
<td align="left">08077</td>
<td align="left">Mesa</td>
<td align="right">146723</td>
</tr>
<tr class="odd">
<td align="left">08101</td>
<td align="left">Pueblo</td>
<td align="right">159063</td>
</tr>
<tr class="even">
<td align="left">08123</td>
<td align="left">Weld</td>
<td align="right">252825</td>
</tr>
<tr class="odd">
<td align="left">08001</td>
<td align="left">Adams</td>
<td align="right">441603</td>
</tr>
<tr class="even">
<td align="left">08005</td>
<td align="left">Arapahoe</td>
<td align="right">572003</td>
</tr>
<tr class="odd">
<td align="left">08013</td>
<td align="left">Boulder</td>
<td align="right">294567</td>
</tr>
</tbody>
</table>
<p>Note that the table is not arranged in order, with respect to the population. Let’s reorder the dataset’s rows, in descending order with respect to the population variable (such that the most populous county appears in the first row):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb22-1" aria-hidden="true" tabindex="-1"></a>CO_large_counties<span class="ot">&lt;-</span>CO_large_counties <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb22-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">arrange</span>(<span class="fu">desc</span>(population))</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_large_counties)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">County</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08041</td>
<td align="left">El Paso</td>
<td align="right">622263</td>
</tr>
<tr class="even">
<td align="left">08031</td>
<td align="left">Denver</td>
<td align="right">600158</td>
</tr>
<tr class="odd">
<td align="left">08005</td>
<td align="left">Arapahoe</td>
<td align="right">572003</td>
</tr>
<tr class="even">
<td align="left">08059</td>
<td align="left">Jefferson</td>
<td align="right">534543</td>
</tr>
<tr class="odd">
<td align="left">08001</td>
<td align="left">Adams</td>
<td align="right">441603</td>
</tr>
<tr class="even">
<td align="left">08069</td>
<td align="left">Larimer</td>
<td align="right">299630</td>
</tr>
<tr class="odd">
<td align="left">08013</td>
<td align="left">Boulder</td>
<td align="right">294567</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="left">Douglas</td>
<td align="right">285465</td>
</tr>
<tr class="odd">
<td align="left">08123</td>
<td align="left">Weld</td>
<td align="right">252825</td>
</tr>
<tr class="even">
<td align="left">08101</td>
<td align="left">Pueblo</td>
<td align="right">159063</td>
</tr>
<tr class="odd">
<td align="left">08077</td>
<td align="left">Mesa</td>
<td align="right">146723</td>
</tr>
</tbody>
</table>
<p>If we want to arrange the dataset in ascending order with respect to the population (such that the least populous county appears on top), we can use the following:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb24-1" aria-hidden="true" tabindex="-1"></a>CO_large_counties<span class="ot">&lt;-</span>CO_large_counties <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb24-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">arrange</span>(population)</span>
<span id="cb24-3"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_large_counties)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">County</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08077</td>
<td align="left">Mesa</td>
<td align="right">146723</td>
</tr>
<tr class="even">
<td align="left">08101</td>
<td align="left">Pueblo</td>
<td align="right">159063</td>
</tr>
<tr class="odd">
<td align="left">08123</td>
<td align="left">Weld</td>
<td align="right">252825</td>
</tr>
<tr class="even">
<td align="left">08035</td>
<td align="left">Douglas</td>
<td align="right">285465</td>
</tr>
<tr class="odd">
<td align="left">08013</td>
<td align="left">Boulder</td>
<td align="right">294567</td>
</tr>
<tr class="even">
<td align="left">08069</td>
<td align="left">Larimer</td>
<td align="right">299630</td>
</tr>
<tr class="odd">
<td align="left">08001</td>
<td align="left">Adams</td>
<td align="right">441603</td>
</tr>
<tr class="even">
<td align="left">08059</td>
<td align="left">Jefferson</td>
<td align="right">534543</td>
</tr>
<tr class="odd">
<td align="left">08005</td>
<td align="left">Arapahoe</td>
<td align="right">572003</td>
</tr>
<tr class="even">
<td align="left">08031</td>
<td align="left">Denver</td>
<td align="right">600158</td>
</tr>
<tr class="odd">
<td align="left">08041</td>
<td align="left">El Paso</td>
<td align="right">622263</td>
</tr>
</tbody>
</table>
<p>It is also possible to filter based on text; for example, if we want to extract the record for Denver, we could use the following (note the double equal sign in the expression):</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb25-1" aria-hidden="true" tabindex="-1"></a>CO_large_counties <span class="sc">%&gt;%</span> <span class="fu">filter</span>(County<span class="sc">==</span><span class="st">&quot;Denver&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   GEOID County population
##   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;
## 1 08031 Denver     600158</code></pre>
<p>Note that above, we didn’t assign this subsetted record to it’s own object, but we could have easily done so. Below, let’s subset Denver and Boulder counties, and assign these records to a new object, named <code>denver_boulder</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb27-1" aria-hidden="true" tabindex="-1"></a>denver_boulder<span class="ot">&lt;-</span>CO_large_counties <span class="sc">%&gt;%</span> <span class="fu">filter</span>(County<span class="sc">==</span><span class="st">&quot;Denver&quot;</span><span class="sc">|</span>County<span class="sc">==</span><span class="st">&quot;Boulder&quot;</span>)</span>
<span id="cb27-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(denver_boulder)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(denver_boulder)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">County</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08013</td>
<td align="left">Boulder</td>
<td align="right">294567</td>
</tr>
<tr class="even">
<td align="left">08031</td>
<td align="left">Denver</td>
<td align="right">600158</td>
</tr>
</tbody>
</table>
<p>Note the syntax above; the code that reads <code>filter(County=="Denver"|County=="Boulder</code>) specifies that we want to pull out all records where the “County” column takes on the value “Denver” OR (denoted by the <code>|</code>) “Boulder”.</p>
<p>While <code>filter</code> is the most common function used to subset data according to specified criteria, there are others that come in handy as well.</p>
</div>
<div id="slice-functions" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> <code>slice</code> functions</h3>
<p>It is often useful to extract rows with particularly high or low values for a given variable. This is where the <code>slice</code> functions of <strong><em>dplyr</em></strong> can come in handy. Let’s say we want to extract the county with the largest population in the <code>CO_county_population_2010_cleaned</code> dataset; we can do so by passing the “population” variable as an argument to the <code>slice_max</code> function:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb29-1" aria-hidden="true" tabindex="-1"></a>CO_county_population_2010_cleaned <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(population)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   GEOID County  population
##   &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;
## 1 08041 El Paso     622263</code></pre>
<p>If we don’t want the single largest county by population, it is easy to extract records with the “n” largest values of a variable by specifying <code>n</code> as an argument. For example, if we wanted the four most populous counties, we would specify <code>n=4</code> after the population argument:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb31-1" aria-hidden="true" tabindex="-1"></a>CO_county_population_2010_cleaned <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(population, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   GEOID County    population
##   &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;
## 1 08041 El Paso       622263
## 2 08031 Denver        600158
## 3 08005 Arapahoe      572003
## 4 08059 Jefferson     534543</code></pre>
<p>The <code>slice_min</code> function is analogous to the <code>slice_max</code> function, but extracts the rows associated with the “n” smallest values of a variable. For example, the code below extracts the 8 smallest counties by population (note that unlike in the <code>slice_max</code> example, we’ll assign the resulting subset to a new object, named <code>CO_counties_8smallest</code>):</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb33-1" aria-hidden="true" tabindex="-1"></a>CO_counties_8smallest<span class="ot">&lt;-</span>CO_county_population_2010_cleaned <span class="sc">%&gt;%</span> <span class="fu">slice_min</span>(population, <span class="at">n=</span><span class="dv">8</span>)</span>
<span id="cb33-2"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CO_counties_8smallest)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOID</th>
<th align="left">County</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">08111</td>
<td align="left">San Juan</td>
<td align="right">699</td>
</tr>
<tr class="even">
<td align="left">08079</td>
<td align="left">Mineral</td>
<td align="right">712</td>
</tr>
<tr class="odd">
<td align="left">08053</td>
<td align="left">Hinsdale</td>
<td align="right">843</td>
</tr>
<tr class="even">
<td align="left">08057</td>
<td align="left">Jackson</td>
<td align="right">1394</td>
</tr>
<tr class="odd">
<td align="left">08061</td>
<td align="left">Kiowa</td>
<td align="right">1398</td>
</tr>
<tr class="even">
<td align="left">08017</td>
<td align="left">Cheyenne</td>
<td align="right">1836</td>
</tr>
<tr class="odd">
<td align="left">08033</td>
<td align="left">Dolores</td>
<td align="right">2064</td>
</tr>
<tr class="even">
<td align="left">08115</td>
<td align="left">Sedgwick</td>
<td align="right">2379</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="creating-new-variables" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Creating new variables</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-data-retrieval.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="grouping-operations-and-summary-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aranganath24/R_Census/edit/master/03-basic_cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/aranganath24/R_Census/blob/master/03-basic_cleaning.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
