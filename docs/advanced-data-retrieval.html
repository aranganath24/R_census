<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Advanced data retrieval | Working with Census Data in R Studio</title>
  <meta name="description" content="8 Advanced data retrieval | Working with Census Data in R Studio" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Advanced data retrieval | Working with Census Data in R Studio" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Advanced data retrieval | Working with Census Data in R Studio" />
  
  
  

<meta name="author" content="Aditya Ranganath" />


<meta name="date" content="2022-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="functions-and-iteration.html"/>
<link rel="next" href="working-with-multiple-datasets.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Census Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>2</b> Preliminaries</a></li>
<li class="part"><span><b>I Decennial Census</b></span></li>
<li class="chapter" data-level="3" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html"><i class="fa fa-check"></i><b>3</b> Basic Data Retrieval</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#load-table-of-variables"><i class="fa fa-check"></i><b>3.1</b> Load table of variables</a></li>
<li class="chapter" data-level="3.2" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#query-the-census-api-and-retrieve-data-using-tidycensus"><i class="fa fa-check"></i><b>3.2</b> Query the census API, and retrieve data using tidycensus</a></li>
<li class="chapter" data-level="3.3" data-path="basic-data-retrieval.html"><a href="basic-data-retrieval.html#modify-a-census-api-call-by-altering-arguments-to-the-get_decennial-function"><i class="fa fa-check"></i><b>3.3</b> Modify a census API call by altering arguments to the “get_decennial” function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>4</b> Basic data cleaning and manipulation with <em>dplyr</em></a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#renaming-and-deleting-columns"><i class="fa fa-check"></i><b>4.1</b> Renaming and deleting columns</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-rename-and-select-functions"><i class="fa fa-check"></i><b>4.1.1</b> The <code>rename</code> and <code>select</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#modifying-columns"><i class="fa fa-check"></i><b>4.2</b> Modifying columns</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#columns-and-string-operations"><i class="fa fa-check"></i><b>4.2.1</b> Columns and string operations</a></li>
<li class="chapter" data-level="4.2.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-relocate-function"><i class="fa fa-check"></i><b>4.2.2</b> The <code>relocate</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#subsetting-data"><i class="fa fa-check"></i><b>4.3</b> Subsetting Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#the-filter-function"><i class="fa fa-check"></i><b>4.3.1</b> The <code>filter</code> function</a></li>
<li class="chapter" data-level="4.3.2" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#slice-functions"><i class="fa fa-check"></i><b>4.3.2</b> <code>slice</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="basic-data-cleaning-and-manipulation-with-dplyr.html"><a href="basic-data-cleaning-and-manipulation-with-dplyr.html#creating-new-variables"><i class="fa fa-check"></i><b>4.4</b> Creating new variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="grouping-operations-and-summary-statistics.html"><a href="grouping-operations-and-summary-statistics.html"><i class="fa fa-check"></i><b>5</b> Grouping operations and summary statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="grouping-operations-and-summary-statistics.html"><a href="grouping-operations-and-summary-statistics.html#aggregate-summary-statistics"><i class="fa fa-check"></i><b>5.1</b> Aggregate summary statistics</a></li>
<li class="chapter" data-level="5.2" data-path="grouping-operations-and-summary-statistics.html"><a href="grouping-operations-and-summary-statistics.html#summary-statistics-by-group"><i class="fa fa-check"></i><b>5.2</b> Summary statistics by group</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="elementary-visualization.html"><a href="elementary-visualization.html"><i class="fa fa-check"></i><b>6</b> Elementary Visualization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="elementary-visualization.html"><a href="elementary-visualization.html#census-data-visualization-with-ggplot"><i class="fa fa-check"></i><b>6.1</b> Census data visualization with <em>ggplot</em></a></li>
<li class="chapter" data-level="6.2" data-path="elementary-visualization.html"><a href="elementary-visualization.html#spatial-visualization-with-tmap"><i class="fa fa-check"></i><b>6.2</b> Spatial visualization with <em>tmap</em></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html"><i class="fa fa-check"></i><b>7</b> Functions and Iteration</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#automate-creation-of-county-level-median-age-graphs"><i class="fa fa-check"></i><b>7.1</b> Automate creation of county-level median age graphs</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#write-county-level-median-age-graph-function"><i class="fa fa-check"></i><b>7.1.1</b> Write county-level median age graph function</a></li>
<li class="chapter" data-level="7.1.2" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#iteratively-apply-median_age_graph-function-to-multiple-input-elements"><i class="fa fa-check"></i><b>7.1.2</b> Iteratively apply <code>median_age_graph</code> function to multiple input elements</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#automate-creation-of-median-age-maps"><i class="fa fa-check"></i><b>7.2</b> Automate creation of median-age maps</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#write-function-to-create-county-level-median-age-maps"><i class="fa fa-check"></i><b>7.2.1</b> Write function to create county-level median age maps</a></li>
<li class="chapter" data-level="7.2.2" data-path="functions-and-iteration.html"><a href="functions-and-iteration.html#iteratively-apply-median_age_map-function-to-multiple-input-elements"><i class="fa fa-check"></i><b>7.2.2</b> Iteratively apply <code>median_age_map</code> function to multiple input elements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html"><i class="fa fa-check"></i><b>8</b> Advanced data retrieval</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-data-from-multiple-census-years"><i class="fa fa-check"></i><b>8.1</b> Retrieving data from multiple census years</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-different-census-year-datasets-and-placing-them-as-separate-elements-in-a-list"><i class="fa fa-check"></i><b>8.1.1</b> Retrieving different census year datasets and placing them as separate elements in a list</a></li>
<li class="chapter" data-level="8.1.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-different-census-year-datasets-and-placing-them-in-a-single-data-frame"><i class="fa fa-check"></i><b>8.1.2</b> Retrieving different census year datasets and placing them in a single data frame</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-data-from-multiple-states"><i class="fa fa-check"></i><b>8.2</b> Retrieving microgeography data from multiple states</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-datasets-for-multiple-states-and-placing-datasets-into-a-list"><i class="fa fa-check"></i><b>8.2.1</b> Retrieving microgeography datasets for multiple states and placing datasets into a list</a></li>
<li class="chapter" data-level="8.2.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-data-from-multiple-states-and-placing-them-into-the-same-data-frame"><i class="fa fa-check"></i><b>8.2.2</b> Retrieving microgeography data from multiple states and placing them into the same data frame</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-microgeography-data-from-multiple-states-and-multiple-years"><i class="fa fa-check"></i><b>8.3</b> Retrieving microgeography data from multiple states AND multiple years</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-data-from-multiple-years-for-multiple-states-and-placing-the-datasets-from-the-various-stateyear-combinations-into-a-list"><i class="fa fa-check"></i><b>8.3.1</b> Retrieving data from multiple years, for multiple states, and placing the datasets from the various state/year combinations into a list</a></li>
<li class="chapter" data-level="8.3.2" data-path="advanced-data-retrieval.html"><a href="advanced-data-retrieval.html#retrieving-data-from-multiple-years-for-multiple-states-and-placing-all-of-the-data-into-a-single-data-frame"><i class="fa fa-check"></i><b>8.3.2</b> Retrieving data from multiple years, for multiple states, and placing all of the data into a single data frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="working-with-multiple-datasets.html"><a href="working-with-multiple-datasets.html"><i class="fa fa-check"></i><b>9</b> Working with multiple datasets</a>
<ul>
<li class="chapter" data-level="9.1" data-path="working-with-multiple-datasets.html"><a href="working-with-multiple-datasets.html#using-functions-and-iteration-to-clean-multiple-datasets"><i class="fa fa-check"></i><b>9.1</b> Using functions and iteration to clean multiple datasets</a></li>
<li class="chapter" data-level="9.2" data-path="working-with-multiple-datasets.html"><a href="working-with-multiple-datasets.html#joining-datasets"><i class="fa fa-check"></i><b>9.2</b> Joining datasets</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html"><i class="fa fa-check"></i><b>10</b> Exporting R Objects</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-a-single-object"><i class="fa fa-check"></i><b>10.1</b> Exporting a single object</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-a-single-dataset-to-disk-as-a-csv-file"><i class="fa fa-check"></i><b>10.1.1</b> Exporting a single dataset to disk as a CSV file</a></li>
<li class="chapter" data-level="10.1.2" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-a-single-map-to-disk-as-a-png-jpeg-or-pdf-file-with-tmap_save"><i class="fa fa-check"></i><b>10.1.2</b> Exporting a single map to disk as a png, jpeg, or PDF file with <code>tmap_save</code></a></li>
<li class="chapter" data-level="10.1.3" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-a-single-ggplot-visualization-to-disk-as-a-png-jpeg-or-pdf-file-with-ggsave"><i class="fa fa-check"></i><b>10.1.3</b> Exporting a single ggplot visualization to disk as a png, jpeg, or PDF file with “ggsave”</a></li>
<li class="chapter" data-level="10.1.4" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-a-single-ggplot-or-tmap-visualization-with-a-graphics-device"><i class="fa fa-check"></i><b>10.1.4</b> Exporting a single ggplot or tmap visualization with a graphics device</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-multiple-objects"><i class="fa fa-check"></i><b>10.2</b> Exporting multiple objects</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-multiple-csv-files-stored-in-a-list"><i class="fa fa-check"></i><b>10.2.1</b> Exporting multiple csv files stored in a list</a></li>
<li class="chapter" data-level="10.2.2" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#exporting-multiple-csv-files-stored-as-separate-objects-in-the-global-environment"><i class="fa fa-check"></i><b>10.2.2</b> Exporting multiple csv files stored as separate objects in the global environment</a></li>
<li class="chapter" data-level="10.2.3" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#using-a-graphics-device-to-export-multiple-objects-from-a-list-into-a-single-pdf-file"><i class="fa fa-check"></i><b>10.2.3</b> Using a graphics device to export multiple objects from a list into a single PDF file</a></li>
<li class="chapter" data-level="10.2.4" data-path="exporting-r-objects.html"><a href="exporting-r-objects.html#writing-out-multiple-tmap-or-ggplot-objects-as-separate-files"><i class="fa fa-check"></i><b>10.2.4</b> Writing out multiple “tmap” or “ggplot” objects as separate files</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II American Community Survey (ACS)</b></span></li>
<li class="chapter" data-level="11" data-path="acs-data-retrieval.html"><a href="acs-data-retrieval.html"><i class="fa fa-check"></i><b>11</b> ACS Data Retrieval</a>
<ul>
<li class="chapter" data-level="11.1" data-path="acs-data-retrieval.html"><a href="acs-data-retrieval.html#extracting-variable-codes-for-acs-data"><i class="fa fa-check"></i><b>11.1</b> Extracting variable codes for ACS data</a></li>
<li class="chapter" data-level="11.2" data-path="acs-data-retrieval.html"><a href="acs-data-retrieval.html#calling-acs-data-with-tidycensus"><i class="fa fa-check"></i><b>11.2</b> Calling ACS data with <code>tidycensus</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="exploratory-analysis-and-visualization-with-acs-data.html"><a href="exploratory-analysis-and-visualization-with-acs-data.html"><i class="fa fa-check"></i><b>12</b> Exploratory analysis and visualization with ACS data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="exploratory-analysis-and-visualization-with-acs-data.html"><a href="exploratory-analysis-and-visualization-with-acs-data.html#identifying-and-visualizing-the-counties-from-each-state-with-the-highest-median-income"><i class="fa fa-check"></i><b>12.1</b> Identifying and visualizing the counties from each state with the highest median income</a></li>
<li class="chapter" data-level="12.2" data-path="exploratory-analysis-and-visualization-with-acs-data.html"><a href="exploratory-analysis-and-visualization-with-acs-data.html#visualizing-county-level-median-income-for-colorado"><i class="fa fa-check"></i><b>12.2</b> Visualizing county-level median income for Colorado</a></li>
<li class="chapter" data-level="12.3" data-path="exploratory-analysis-and-visualization-with-acs-data.html"><a href="exploratory-analysis-and-visualization-with-acs-data.html#writing-functions-to-visualize-acs-data"><i class="fa fa-check"></i><b>12.3</b> Writing functions to visualize ACS data</a></li>
<li class="chapter" data-level="12.4" data-path="exploratory-analysis-and-visualization-with-acs-data.html"><a href="exploratory-analysis-and-visualization-with-acs-data.html#dynamic-mapping"><i class="fa fa-check"></i><b>12.4</b> Dynamic mapping</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="bivariate-analysis-with-acs-data-education-and-income.html"><a href="bivariate-analysis-with-acs-data-education-and-income.html"><i class="fa fa-check"></i><b>13</b> Bivariate Analysis with ACS Data: Education and Income</a></li>
<li class="chapter" data-level="14" data-path="integrating-census-data-and-external-data.html"><a href="integrating-census-data-and-external-data.html"><i class="fa fa-check"></i><b>14</b> Integrating census data and external data</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Working with Census Data in R Studio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-data-retrieval" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Advanced data retrieval</h1>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="advanced-data-retrieval.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use tidycensus to extract tract-level data from Colorado and Utah on population (P001001) and rural population (P002005) based on 2000 decennial census; assigns data to object named &quot;population_rural_CO_UT&quot;</span></span>
<span id="cb108-2"><a href="advanced-data-retrieval.html#cb108-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT<span class="ot">&lt;-</span><span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">&quot;tract&quot;</span>,</span>
<span id="cb108-3"><a href="advanced-data-retrieval.html#cb108-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">state=</span><span class="fu">c</span>(<span class="st">&quot;CO&quot;</span>, <span class="st">&quot;UT&quot;</span>),</span>
<span id="cb108-4"><a href="advanced-data-retrieval.html#cb108-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;P001001&quot;</span>, <span class="st">&quot;P002005&quot;</span>),</span>
<span id="cb108-5"><a href="advanced-data-retrieval.html#cb108-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">output=</span><span class="st">&quot;wide&quot;</span>,</span>
<span id="cb108-6"><a href="advanced-data-retrieval.html#cb108-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">year =</span> <span class="dv">2000</span>) </span></code></pre></div>
<pre><code>## Getting data from the 2000 decennial Census</code></pre>
<div id="retrieving-data-from-multiple-census-years" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Retrieving data from multiple census years</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="advanced-data-retrieval.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempts to extract state level data (for all US states) on population (P001001) and rural population (P002005) based on 2000 decennial census and 2010 decennial census, and assign to new object named &quot;population_rural_2000_2010&quot;</span></span>
<span id="cb110-2"><a href="advanced-data-retrieval.html#cb110-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010<span class="ot">&lt;-</span><span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">&quot;state&quot;</span>, </span>
<span id="cb110-3"><a href="advanced-data-retrieval.html#cb110-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;P001001&quot;</span>, <span class="st">&quot;P002005&quot;</span>),</span>
<span id="cb110-4"><a href="advanced-data-retrieval.html#cb110-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output=</span><span class="st">&quot;wide&quot;</span>,</span>
<span id="cb110-5"><a href="advanced-data-retrieval.html#cb110-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>)) </span></code></pre></div>
<pre><code>## Getting data from the 2000 decennial CensusGetting data from the 2010 decennial Census</code></pre>
<pre><code>## Warning in if (year == 2020) {: the condition has length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## Warning in if (year == 1990) {: the condition has length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## Warning in if (year == 1990) {: the condition has length &gt; 1 and only the first element will be used

## Warning in if (year == 1990) {: the condition has length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## Error in parse_url(url) : length(url) == 1 is not TRUE</code></pre>
<pre><code>## Variables not found in Summary File 1. Trying Summary File 3...</code></pre>
<pre><code>## Error in UseMethod(&quot;select&quot;): no applicable method for &#39;select&#39; applied to an object of class &quot;character&quot;</code></pre>
<div id="retrieving-different-census-year-datasets-and-placing-them-as-separate-elements-in-a-list" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Retrieving different census year datasets and placing them as separate elements in a list</h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="advanced-data-retrieval.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates function that takes a given year as an input, and uses tidycensus to extract a state-level dataset of population (P001001) and rural population (P002005) for the specified year; the output dataset also includes new columns containing the state&#39;s rural population as a percentage of the overall population (&quot;rural_pct&quot;) and the year to which the data corresponds (&quot;year&quot;); the function is assigned to a new object named &quot;census_query&quot;</span></span>
<span id="cb118-2"><a href="advanced-data-retrieval.html#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="advanced-data-retrieval.html#cb118-3" aria-hidden="true" tabindex="-1"></a>census_query<span class="ot">&lt;-</span><span class="cf">function</span>(desired_year){</span>
<span id="cb118-4"><a href="advanced-data-retrieval.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">&quot;state&quot;</span>, </span>
<span id="cb118-5"><a href="advanced-data-retrieval.html#cb118-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;P001001&quot;</span>, <span class="st">&quot;P002005&quot;</span>),</span>
<span id="cb118-6"><a href="advanced-data-retrieval.html#cb118-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">output=</span><span class="st">&quot;wide&quot;</span>,</span>
<span id="cb118-7"><a href="advanced-data-retrieval.html#cb118-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">year=</span>desired_year) <span class="sc">%&gt;%</span> </span>
<span id="cb118-8"><a href="advanced-data-retrieval.html#cb118-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rural_pct=</span>(P002005<span class="sc">/</span>P001001)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb118-9"><a href="advanced-data-retrieval.html#cb118-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year=</span>desired_year)</span>
<span id="cb118-10"><a href="advanced-data-retrieval.html#cb118-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb118-11"><a href="advanced-data-retrieval.html#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="advanced-data-retrieval.html#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the &quot;census_query&quot; object for the year 2000</span></span>
<span id="cb118-13"><a href="advanced-data-retrieval.html#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="fu">census_query</span>(<span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## # A tibble: 52 x 6
##    GEOID NAME                  P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama               4447100 1981427     44.6   2000
##  2 02    Alaska                 626932  215675     34.4   2000
##  3 04    Arizona               5130632  607097     11.8   2000
##  4 05    Arkansas              2673400 1269221     47.5   2000
##  5 06    California           33871648 1881985      5.56  2000
##  6 08    Colorado              4301261  668076     15.5   2000
##  7 09    Connecticut           3405565  417506     12.3   2000
##  8 10    Delaware               783600  155842     19.9   2000
##  9 11    District of Columbia   572059       0      0     2000
## 10 12    Florida              15982378 1712358     10.7   2000
## # … with 42 more rows</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="advanced-data-retrieval.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates a new vector, assigned to an object named &quot;my_years&quot;, containing the years for which we want to extract data</span></span>
<span id="cb120-2"><a href="advanced-data-retrieval.html#cb120-2" aria-hidden="true" tabindex="-1"></a>my_years<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>)</span>
<span id="cb120-3"><a href="advanced-data-retrieval.html#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="advanced-data-retrieval.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Applies the &quot;census_query&quot; function to the inputs specified by the &quot;my_years&quot; vector, and deposits the two resulting datasets (one from 2000 and the other from 2010) as distinct elements in a list assigned to an object named population_rural_2000_2010_list</span></span>
<span id="cb120-5"><a href="advanced-data-retrieval.html#cb120-5" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list<span class="ot">&lt;-</span><span class="fu">map</span>(<span class="at">.x=</span>my_years, <span class="at">.f=</span>census_query)</span></code></pre></div>
<pre><code>## Getting data from the 2000 decennial Census</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="advanced-data-retrieval.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints the contents of &quot;population_rural_2000_2010_list&quot;</span></span>
<span id="cb125-2"><a href="advanced-data-retrieval.html#cb125-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list</span></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 52 x 6
##    GEOID NAME                  P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama               4447100 1981427     44.6   2000
##  2 02    Alaska                 626932  215675     34.4   2000
##  3 04    Arizona               5130632  607097     11.8   2000
##  4 05    Arkansas              2673400 1269221     47.5   2000
##  5 06    California           33871648 1881985      5.56  2000
##  6 08    Colorado              4301261  668076     15.5   2000
##  7 09    Connecticut           3405565  417506     12.3   2000
##  8 10    Delaware               783600  155842     19.9   2000
##  9 11    District of Columbia   572059       0      0     2000
## 10 12    Florida              15982378 1712358     10.7   2000
## # … with 42 more rows
## 
## [[2]]
## # A tibble: 52 x 6
##    GEOID NAME         P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama      4779736 1957932     41.0   2010
##  2 02    Alaska        710231  241338     34.0   2010
##  3 04    Arizona      6392017  651358     10.2   2010
##  4 05    Arkansas     2915918 1278329     43.8   2010
##  5 06    California  37253956 1880350      5.05  2010
##  6 22    Louisiana    4533372 1215567     26.8   2010
##  7 21    Kentucky     4339367 1806024     41.6   2010
##  8 08    Colorado     5029196  696435     13.8   2010
##  9 09    Connecticut  3574097  429155     12.0   2010
## 10 10    Delaware      897934  149985     16.7   2010
## # … with 42 more rows</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="advanced-data-retrieval.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracts the first list element (the 2000 dataset) from the list using its index</span></span>
<span id="cb127-2"><a href="advanced-data-retrieval.html#cb127-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 52 x 6
##    GEOID NAME                  P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama               4447100 1981427     44.6   2000
##  2 02    Alaska                 626932  215675     34.4   2000
##  3 04    Arizona               5130632  607097     11.8   2000
##  4 05    Arkansas              2673400 1269221     47.5   2000
##  5 06    California           33871648 1881985      5.56  2000
##  6 08    Colorado              4301261  668076     15.5   2000
##  7 09    Connecticut           3405565  417506     12.3   2000
##  8 10    Delaware               783600  155842     19.9   2000
##  9 11    District of Columbia   572059       0      0     2000
## 10 12    Florida              15982378 1712358     10.7   2000
## # … with 42 more rows</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="advanced-data-retrieval.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Names the list elements based on the input years (i.e. the years in &quot;my_years&quot;)</span></span>
<span id="cb129-2"><a href="advanced-data-retrieval.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(population_rural_2000_2010_list)<span class="ot">&lt;-</span>my_years</span>
<span id="cb129-3"><a href="advanced-data-retrieval.html#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="advanced-data-retrieval.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prints &quot;population_rural_2000_2010_list&quot;; notice the list elements are now named after the years to which they correspond </span></span>
<span id="cb129-5"><a href="advanced-data-retrieval.html#cb129-5" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list</span></code></pre></div>
<pre><code>## $`2000`
## # A tibble: 52 x 6
##    GEOID NAME                  P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama               4447100 1981427     44.6   2000
##  2 02    Alaska                 626932  215675     34.4   2000
##  3 04    Arizona               5130632  607097     11.8   2000
##  4 05    Arkansas              2673400 1269221     47.5   2000
##  5 06    California           33871648 1881985      5.56  2000
##  6 08    Colorado              4301261  668076     15.5   2000
##  7 09    Connecticut           3405565  417506     12.3   2000
##  8 10    Delaware               783600  155842     19.9   2000
##  9 11    District of Columbia   572059       0      0     2000
## 10 12    Florida              15982378 1712358     10.7   2000
## # … with 42 more rows
## 
## $`2010`
## # A tibble: 52 x 6
##    GEOID NAME         P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama      4779736 1957932     41.0   2010
##  2 02    Alaska        710231  241338     34.0   2010
##  3 04    Arizona      6392017  651358     10.2   2010
##  4 05    Arkansas     2915918 1278329     43.8   2010
##  5 06    California  37253956 1880350      5.05  2010
##  6 22    Louisiana    4533372 1215567     26.8   2010
##  7 21    Kentucky     4339367 1806024     41.6   2010
##  8 08    Colorado     5029196  696435     13.8   2010
##  9 09    Connecticut  3574097  429155     12.0   2010
## 10 10    Delaware      897934  149985     16.7   2010
## # … with 42 more rows</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="advanced-data-retrieval.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracts the 2010 dataset from &quot;population_rural_2000_2010_list&quot; using its newly assigned name</span></span>
<span id="cb131-2"><a href="advanced-data-retrieval.html#cb131-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&quot;2010&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 52 x 6
##    GEOID NAME         P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama      4779736 1957932     41.0   2010
##  2 02    Alaska        710231  241338     34.0   2010
##  3 04    Arizona      6392017  651358     10.2   2010
##  4 05    Arkansas     2915918 1278329     43.8   2010
##  5 06    California  37253956 1880350      5.05  2010
##  6 22    Louisiana    4533372 1215567     26.8   2010
##  7 21    Kentucky     4339367 1806024     41.6   2010
##  8 08    Colorado     5029196  696435     13.8   2010
##  9 09    Connecticut  3574097  429155     12.0   2010
## 10 10    Delaware      897934  149985     16.7   2010
## # … with 42 more rows</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="advanced-data-retrieval.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that even if a list element is named, you can still extract it using its index, rather than its name</span></span>
<span id="cb133-2"><a href="advanced-data-retrieval.html#cb133-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_list <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 52 x 6
##    GEOID NAME         P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama      4779736 1957932     41.0   2010
##  2 02    Alaska        710231  241338     34.0   2010
##  3 04    Arizona      6392017  651358     10.2   2010
##  4 05    Arkansas     2915918 1278329     43.8   2010
##  5 06    California  37253956 1880350      5.05  2010
##  6 22    Louisiana    4533372 1215567     26.8   2010
##  7 21    Kentucky     4339367 1806024     41.6   2010
##  8 08    Colorado     5029196  696435     13.8   2010
##  9 09    Connecticut  3574097  429155     12.0   2010
## 10 10    Delaware      897934  149985     16.7   2010
## # … with 42 more rows</code></pre>
</div>
<div id="retrieving-different-census-year-datasets-and-placing-them-in-a-single-data-frame" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Retrieving different census year datasets and placing them in a single data frame</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="advanced-data-retrieval.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applies the &quot;census_query&quot; function to the inputs specified by the &quot;my_years&quot; vector, and deposits the resulting census datasets (one from 2000 and the other from 2010) into a single data frame assigned to an object named &quot;population_rural_2000_2010_df&quot;</span></span>
<span id="cb135-2"><a href="advanced-data-retrieval.html#cb135-2" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_df<span class="ot">&lt;-</span><span class="fu">map_dfr</span>(<span class="at">.x=</span>my_years, <span class="at">.f=</span>census_query) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(GEOID)</span>
<span id="cb135-3"><a href="advanced-data-retrieval.html#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="advanced-data-retrieval.html#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prints the first few records of &quot;population_rural_2000_2010_df&quot; </span></span>
<span id="cb135-5"><a href="advanced-data-retrieval.html#cb135-5" aria-hidden="true" tabindex="-1"></a>population_rural_2000_2010_df</span></code></pre></div>
<pre><code>## # A tibble: 104 x 6
##    GEOID NAME        P001001 P002005 rural_pct  year
##    &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama     4447100 1981427     44.6   2000
##  2 01    Alabama     4779736 1957932     41.0   2010
##  3 02    Alaska       626932  215675     34.4   2000
##  4 02    Alaska       710231  241338     34.0   2010
##  5 04    Arizona     5130632  607097     11.8   2000
##  6 04    Arizona     6392017  651358     10.2   2010
##  7 05    Arkansas    2673400 1269221     47.5   2000
##  8 05    Arkansas    2915918 1278329     43.8   2010
##  9 06    California 33871648 1881985      5.56  2000
## 10 06    California 37253956 1880350      5.05  2010
## # … with 94 more rows</code></pre>
</div>
</div>
<div id="retrieving-microgeography-data-from-multiple-states" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Retrieving microgeography data from multiple states</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="advanced-data-retrieval.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempts to retrieve tract-level data on overall population (P001001) and rural population (P002005) from Colorado and Utah, based on the 2000 decennial census; then, creates a new variable named &quot;rural_pct&quot; that captures each tracts rural share of the overall population, as well as a new variable named &quot;rural_pct&quot;</span></span>
<span id="cb137-2"><a href="advanced-data-retrieval.html#cb137-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT<span class="ot">&lt;-</span><span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">&quot;tract&quot;</span>, </span>
<span id="cb137-3"><a href="advanced-data-retrieval.html#cb137-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">state=</span><span class="fu">c</span>(<span class="st">&quot;CO&quot;</span>,<span class="st">&quot;UT&quot;</span>),</span>
<span id="cb137-4"><a href="advanced-data-retrieval.html#cb137-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;P001001&quot;</span>, <span class="st">&quot;P002005&quot;</span>),</span>
<span id="cb137-5"><a href="advanced-data-retrieval.html#cb137-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">output=</span><span class="st">&quot;wide&quot;</span>,</span>
<span id="cb137-6"><a href="advanced-data-retrieval.html#cb137-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">year=</span><span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb137-7"><a href="advanced-data-retrieval.html#cb137-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">rural_pct=</span>(P002005<span class="sc">/</span>P001001)<span class="sc">*</span><span class="dv">100</span>)         </span></code></pre></div>
<pre><code>## Getting data from the 2000 decennial Census</code></pre>
<div id="retrieving-microgeography-datasets-for-multiple-states-and-placing-datasets-into-a-list" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Retrieving microgeography datasets for multiple states and placing datasets into a list</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="advanced-data-retrieval.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates a function assigned to an object named &quot;population_rural_statetract&quot; that takes a given state input (&quot;desired_state), and passes this state into tidycensus&#39;s &quot;get_decennial&quot; function to retrieve a tract-level dataset for that state containing data on overall population (P001001) and rural population (P002005) based on the 2010 decennial census, while also creating three new variables: &quot;rural_pct&quot; (the percentage of the overall population that is rural), &quot;Year&quot; (a varaiable that takes on the value 2010, so that we can readily identify that the data corresponds to the year 2010), and &quot;STATE&quot; (an ID variable that will take on the value of the state input, so that we can readily identify the state for which the data has been extracted)</span></span>
<span id="cb139-2"><a href="advanced-data-retrieval.html#cb139-2" aria-hidden="true" tabindex="-1"></a>population_rural_statetract<span class="ot">&lt;-</span><span class="cf">function</span>(desired_state){</span>
<span id="cb139-3"><a href="advanced-data-retrieval.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">&quot;tract&quot;</span>, </span>
<span id="cb139-4"><a href="advanced-data-retrieval.html#cb139-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">state=</span>desired_state,</span>
<span id="cb139-5"><a href="advanced-data-retrieval.html#cb139-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;P001001&quot;</span>, <span class="st">&quot;P002005&quot;</span>),</span>
<span id="cb139-6"><a href="advanced-data-retrieval.html#cb139-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">output=</span><span class="st">&quot;wide&quot;</span>,</span>
<span id="cb139-7"><a href="advanced-data-retrieval.html#cb139-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">year=</span><span class="dv">2010</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb139-8"><a href="advanced-data-retrieval.html#cb139-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rural_pct=</span>(P002005<span class="sc">/</span>P001001)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb139-9"><a href="advanced-data-retrieval.html#cb139-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Year=</span><span class="dv">2010</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb139-10"><a href="advanced-data-retrieval.html#cb139-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">STATE=</span>desired_state)</span>
<span id="cb139-11"><a href="advanced-data-retrieval.html#cb139-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-12"><a href="advanced-data-retrieval.html#cb139-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-13"><a href="advanced-data-retrieval.html#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the function for a given state; here, California (&quot;CA)</span></span>
<span id="cb139-14"><a href="advanced-data-retrieval.html#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="fu">population_rural_statetract</span>(<span class="st">&quot;CA&quot;</span>)</span></code></pre></div>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;06&#39; for state &#39;CA&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## # A tibble: 8,057 x 7
##    GEOID       NAME                                                 P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                                  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 06037434004 Census Tract 4340.04, Los Angeles County, California    2796       0         0  2010 CA   
##  2 06037460000 Census Tract 4600, Los Angeles County, California       4851       0         0  2010 CA   
##  3 06037460200 Census Tract 4602, Los Angeles County, California       5315       0         0  2010 CA   
##  4 06037460301 Census Tract 4603.01, Los Angeles County, California    4638       0         0  2010 CA   
##  5 06037460302 Census Tract 4603.02, Los Angeles County, California    4442       0         0  2010 CA   
##  6 06037460401 Census Tract 4604.01, Los Angeles County, California     878       0         0  2010 CA   
##  7 06037621301 Census Tract 6213.01, Los Angeles County, California    6769       0         0  2010 CA   
##  8 06037621324 Census Tract 6213.24, Los Angeles County, California    3842       0         0  2010 CA   
##  9 06037621326 Census Tract 6213.26, Los Angeles County, California    3260       0         0  2010 CA   
## 10 06037621400 Census Tract 6214, Los Angeles County, California       4414       0         0  2010 CA   
## # … with 8,047 more rows</code></pre>
<p>Now that we know the function works, let’s apply it to extract our desired dataset for Colorado and Utah, and place these datasets into a list:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="advanced-data-retrieval.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector of desired states and assign it to an object named &quot;my_states&quot;</span></span>
<span id="cb144-2"><a href="advanced-data-retrieval.html#cb144-2" aria-hidden="true" tabindex="-1"></a>my_states<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;CO&quot;</span>, <span class="st">&quot;UT&quot;</span>)</span>
<span id="cb144-3"><a href="advanced-data-retrieval.html#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="advanced-data-retrieval.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Applies the &quot;population_rural_state_tract&quot; function to the inputs specified by the &quot;my_states&quot; vector, and deposits the two resulting datasets (one for CO, and the other for UT) as distinct elements in a list assigned to an object named population_rural_CO_UT_list</span></span>
<span id="cb144-5"><a href="advanced-data-retrieval.html#cb144-5" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_list<span class="ot">&lt;-</span><span class="fu">map</span>(<span class="at">.x=</span>my_states, <span class="at">.f=</span>population_rural_statetract)</span></code></pre></div>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;08&#39; for state &#39;CO&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;49&#39; for state &#39;UT&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="advanced-data-retrieval.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints the contents of &quot;population_rural_CO_UT_list&quot;</span></span>
<span id="cb151-2"><a href="advanced-data-retrieval.html#cb151-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_list</span></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 1,249 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,239 more rows
## 
## [[2]]
## # A tibble: 588 x 7
##    GEOID       NAME                                     P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 49011125805 Census Tract 1258.05, Davis County, Utah    6167       0         0  2010 UT   
##  2 49011125301 Census Tract 1253.01, Davis County, Utah    5108       0         0  2010 UT   
##  3 49011125305 Census Tract 1253.05, Davis County, Utah    6152       0         0  2010 UT   
##  4 49011125702 Census Tract 1257.02, Davis County, Utah    3839       0         0  2010 UT   
##  5 49011125801 Census Tract 1258.01, Davis County, Utah    6703       0         0  2010 UT   
##  6 49011125804 Census Tract 1258.04, Davis County, Utah    6377       0         0  2010 UT   
##  7 49011125807 Census Tract 1258.07, Davis County, Utah    3114       0         0  2010 UT   
##  8 49011125808 Census Tract 1258.08, Davis County, Utah    5616       0         0  2010 UT   
##  9 49011125905 Census Tract 1259.05, Davis County, Utah    6156       0         0  2010 UT   
## 10 49011125906 Census Tract 1259.06, Davis County, Utah    6987       0         0  2010 UT   
## # … with 578 more rows</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="advanced-data-retrieval.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &quot;pluck&quot; function to extract the Colorado dataset from &quot;population_rural_CO_UT_list&quot; by its index</span></span>
<span id="cb153-2"><a href="advanced-data-retrieval.html#cb153-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_list <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,249 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,239 more rows</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="advanced-data-retrieval.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the list elements in &quot;population_rural_CO_UT_list&quot; based on the &quot;my_states&quot; vector</span></span>
<span id="cb155-2"><a href="advanced-data-retrieval.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(population_rural_CO_UT_list)<span class="ot">&lt;-</span>my_states</span>
<span id="cb155-3"><a href="advanced-data-retrieval.html#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="advanced-data-retrieval.html#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print &quot;population_rural_CO_UT_list&quot; list contents; notice that they&#39;re now named based on the state</span></span>
<span id="cb155-5"><a href="advanced-data-retrieval.html#cb155-5" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_list</span></code></pre></div>
<pre><code>## $CO
## # A tibble: 1,249 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,239 more rows
## 
## $UT
## # A tibble: 588 x 7
##    GEOID       NAME                                     P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 49011125805 Census Tract 1258.05, Davis County, Utah    6167       0         0  2010 UT   
##  2 49011125301 Census Tract 1253.01, Davis County, Utah    5108       0         0  2010 UT   
##  3 49011125305 Census Tract 1253.05, Davis County, Utah    6152       0         0  2010 UT   
##  4 49011125702 Census Tract 1257.02, Davis County, Utah    3839       0         0  2010 UT   
##  5 49011125801 Census Tract 1258.01, Davis County, Utah    6703       0         0  2010 UT   
##  6 49011125804 Census Tract 1258.04, Davis County, Utah    6377       0         0  2010 UT   
##  7 49011125807 Census Tract 1258.07, Davis County, Utah    3114       0         0  2010 UT   
##  8 49011125808 Census Tract 1258.08, Davis County, Utah    5616       0         0  2010 UT   
##  9 49011125905 Census Tract 1259.05, Davis County, Utah    6156       0         0  2010 UT   
## 10 49011125906 Census Tract 1259.06, Davis County, Utah    6987       0         0  2010 UT   
## # … with 578 more rows</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="advanced-data-retrieval.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &quot;pluck&quot; function to extract the Utah dataset from &quot;population_rural_CO_UT_list&quot; by name</span></span>
<span id="cb157-2"><a href="advanced-data-retrieval.html#cb157-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_list <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&quot;UT&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 588 x 7
##    GEOID       NAME                                     P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 49011125805 Census Tract 1258.05, Davis County, Utah    6167       0         0  2010 UT   
##  2 49011125301 Census Tract 1253.01, Davis County, Utah    5108       0         0  2010 UT   
##  3 49011125305 Census Tract 1253.05, Davis County, Utah    6152       0         0  2010 UT   
##  4 49011125702 Census Tract 1257.02, Davis County, Utah    3839       0         0  2010 UT   
##  5 49011125801 Census Tract 1258.01, Davis County, Utah    6703       0         0  2010 UT   
##  6 49011125804 Census Tract 1258.04, Davis County, Utah    6377       0         0  2010 UT   
##  7 49011125807 Census Tract 1258.07, Davis County, Utah    3114       0         0  2010 UT   
##  8 49011125808 Census Tract 1258.08, Davis County, Utah    5616       0         0  2010 UT   
##  9 49011125905 Census Tract 1259.05, Davis County, Utah    6156       0         0  2010 UT   
## 10 49011125906 Census Tract 1259.06, Davis County, Utah    6987       0         0  2010 UT   
## # … with 578 more rows</code></pre>
</div>
<div id="retrieving-microgeography-data-from-multiple-states-and-placing-them-into-the-same-data-frame" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Retrieving microgeography data from multiple states and placing them into the same data frame</h3>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="advanced-data-retrieval.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applies the &quot;population_rural_statetract&quot; function to the inputs specified by the &quot;my_states&quot; vector, and deposits the resulting census datasets (one CO and the other UT) into a single data frame assigned to an object named &quot;population_rural_CO_UT_df&quot;</span></span>
<span id="cb159-2"><a href="advanced-data-retrieval.html#cb159-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_df<span class="ot">&lt;-</span><span class="fu">map_dfr</span>(<span class="at">.x=</span>my_states, <span class="at">.f=</span>population_rural_statetract)</span></code></pre></div>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;08&#39; for state &#39;CO&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;49&#39; for state &#39;UT&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="advanced-data-retrieval.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints the contents of &quot;population_rural_CO_UT_df&quot;</span></span>
<span id="cb166-2"><a href="advanced-data-retrieval.html#cb166-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_df</span></code></pre></div>
<pre><code>## # A tibble: 1,837 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  Year STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,827 more rows</code></pre>
</div>
</div>
<div id="retrieving-microgeography-data-from-multiple-states-and-multiple-years" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Retrieving microgeography data from multiple states AND multiple years</h2>
<p>We can use the same principles to extract census datasets at sub-state geographies for multiple states, across from multiple years.</p>
<div id="retrieving-data-from-multiple-years-for-multiple-states-and-placing-the-datasets-from-the-various-stateyear-combinations-into-a-list" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Retrieving data from multiple years, for multiple states, and placing the datasets from the various state/year combinations into a list</h3>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="advanced-data-retrieval.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function (assigned to an object named &quot;population_rural_statetract_year&quot;) that takes a state input (&quot;desired_state&quot;) and a year input (&quot;desired_year), and returns a tract level dataset for that state and census year which contains variables specifying the total population, and the rural population, while also creating three new variables: &quot;rural_pct&quot; (the percentage of the overall tract population that is rural), &quot;YEAR&quot; (a varaiable that takes on the value of the input, so that we can readily identify what year the data corresponds to), and &quot;STATE&quot; (an ID variable that will take on the value of the state input, so that we can readily identify the state for which the data has been extracted)</span></span>
<span id="cb168-2"><a href="advanced-data-retrieval.html#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="advanced-data-retrieval.html#cb168-3" aria-hidden="true" tabindex="-1"></a>population_rural_statetract_year<span class="ot">&lt;-</span><span class="cf">function</span>(desired_state, desired_year){</span>
<span id="cb168-4"><a href="advanced-data-retrieval.html#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">&quot;tract&quot;</span>, </span>
<span id="cb168-5"><a href="advanced-data-retrieval.html#cb168-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">state=</span>desired_state,</span>
<span id="cb168-6"><a href="advanced-data-retrieval.html#cb168-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;P001001&quot;</span>, <span class="st">&quot;P002005&quot;</span>),</span>
<span id="cb168-7"><a href="advanced-data-retrieval.html#cb168-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">output=</span><span class="st">&quot;wide&quot;</span>,</span>
<span id="cb168-8"><a href="advanced-data-retrieval.html#cb168-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">year=</span>desired_year) <span class="sc">%&gt;%</span> </span>
<span id="cb168-9"><a href="advanced-data-retrieval.html#cb168-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rural_pct=</span>(P002005<span class="sc">/</span>P001001)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb168-10"><a href="advanced-data-retrieval.html#cb168-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">YEAR=</span>desired_year) <span class="sc">%&gt;%</span> </span>
<span id="cb168-11"><a href="advanced-data-retrieval.html#cb168-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">STATE=</span>desired_state)</span>
<span id="cb168-12"><a href="advanced-data-retrieval.html#cb168-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-13"><a href="advanced-data-retrieval.html#cb168-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-14"><a href="advanced-data-retrieval.html#cb168-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests the &quot;population_rural_CO_UT_2000_2010&quot; function for Virginia, for the 2010 census</span></span>
<span id="cb168-15"><a href="advanced-data-retrieval.html#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="fu">population_rural_statetract_year</span>(<span class="st">&quot;VA&quot;</span>, <span class="dv">2010</span>) </span></code></pre></div>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;51&#39; for state &#39;VA&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## # A tibble: 1,907 x 7
##    GEOID       NAME                                           P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                            &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 51059421200 Census Tract 4212, Fairfax County, Virginia       1926       0         0  2010 VA   
##  2 51059421400 Census Tract 4214, Fairfax County, Virginia       7158       0         0  2010 VA   
##  3 51059421600 Census Tract 4216, Fairfax County, Virginia       6342       0         0  2010 VA   
##  4 51059421702 Census Tract 4217.02, Fairfax County, Virginia    4054       0         0  2010 VA   
##  5 51059421800 Census Tract 4218, Fairfax County, Virginia       5862       0         0  2010 VA   
##  6 51059421900 Census Tract 4219, Fairfax County, Virginia       2216       0         0  2010 VA   
##  7 51059422000 Census Tract 4220, Fairfax County, Virginia       3439       0         0  2010 VA   
##  8 51059422102 Census Tract 4221.02, Fairfax County, Virginia    6101       0         0  2010 VA   
##  9 51059422201 Census Tract 4222.01, Fairfax County, Virginia    3394       0         0  2010 VA   
## 10 51059422202 Census Tract 4222.02, Fairfax County, Virginia    5518       0         0  2010 VA   
## # … with 1,897 more rows</code></pre>
<p>Now, we can iteratively apply the <code>population_rural_statetract_year</code> function to multiple state/year inputs. In the example below, we use <code>population_rural_statetract_year</code> to extract data from the 2000 and 2010 censuses, for both Colorado and Utah, and deposit the resulting four datasets (CO/2000, CO/2010, UT/2000, UT/2010) into a list</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="advanced-data-retrieval.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector of desired states to iterate over, and assign it to an obejct named &quot;my_states&quot;</span></span>
<span id="cb173-2"><a href="advanced-data-retrieval.html#cb173-2" aria-hidden="true" tabindex="-1"></a>my_states<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;CO&quot;</span>, <span class="st">&quot;CO&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;UT&quot;</span>)</span>
<span id="cb173-3"><a href="advanced-data-retrieval.html#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="advanced-data-retrieval.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector of desired years to iterate over, and assign it to an object named &quot;my_years&quot;</span></span>
<span id="cb173-5"><a href="advanced-data-retrieval.html#cb173-5" aria-hidden="true" tabindex="-1"></a>my_years<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2000</span>, <span class="dv">2010</span>)</span>
<span id="cb173-6"><a href="advanced-data-retrieval.html#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="advanced-data-retrieval.html#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Applies the &quot;population_rural_statetract_year&quot; function to the inputs specified by the &quot;my_states&quot; and &quot;my_year&quot; vectors, and deposits the resulting four census datasets (one for CO 2000; one for CO 2010; one for UT 2000; one for UT 2010)  as distinct elements in a list that is assigned to an object named &quot;population_rural_CO_UT_2000_2010_list&quot;</span></span>
<span id="cb173-8"><a href="advanced-data-retrieval.html#cb173-8" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_2000_2010_list<span class="ot">&lt;-</span><span class="fu">map2</span>(<span class="at">.x=</span>my_states, <span class="at">.y=</span>my_years, <span class="at">.f=</span>population_rural_statetract_year)</span></code></pre></div>
<pre><code>## Getting data from the 2000 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;08&#39; for state &#39;CO&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;08&#39; for state &#39;CO&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2000 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;49&#39; for state &#39;UT&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;49&#39; for state &#39;UT&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="advanced-data-retrieval.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints contents of &quot;population_rural_CO_UT_2000_2010_list&quot;</span></span>
<span id="cb186-2"><a href="advanced-data-retrieval.html#cb186-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_2000_2010_list</span></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 1,062 x 7
##    GEOID       NAME                                       P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08001007800 Census Tract 78, Adams County, Colorado       8378       0      0     2000 CO   
##  2 08001007900 Census Tract 79, Adams County, Colorado       6617       0      0     2000 CO   
##  3 08001008000 Census Tract 80, Adams County, Colorado       6183       0      0     2000 CO   
##  4 08001008100 Census Tract 81, Adams County, Colorado       1050       0      0     2000 CO   
##  5 08001008200 Census Tract 82, Adams County, Colorado       5393       0      0     2000 CO   
##  6 08001008308 Census Tract 83.08, Adams County, Colorado    4972       0      0     2000 CO   
##  7 08001008309 Census Tract 83.09, Adams County, Colorado    3052      50      1.64  2000 CO   
##  8 08001008353 Census Tract 83.53, Adams County, Colorado    4612     174      3.77  2000 CO   
##  9 08001008385 Census Tract 83.85, Adams County, Colorado       0       0    NaN     2000 CO   
## 10 08001008401 Census Tract 84.01, Adams County, Colorado    3261    3261    100     2000 CO   
## # … with 1,052 more rows
## 
## [[2]]
## # A tibble: 1,249 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,239 more rows
## 
## [[3]]
## # A tibble: 496 x 7
##    GEOID       NAME                                         P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                          &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 49001100100 Census Tract 1001, Beaver County, Utah          3314    3314    100     2000 UT   
##  2 49001100200 Census Tract 1002, Beaver County, Utah          2691    2691    100     2000 UT   
##  3 49003960100 Census Tract 9601, Box Elder County, Utah       2712    2712    100     2000 UT   
##  4 49003960200 Census Tract 9602, Box Elder County, Utah       6037    4134     68.5   2000 UT   
##  5 49003960300 Census Tract 9603, Box Elder County, Utah       6223     889     14.3   2000 UT   
##  6 49003960400 Census Tract 9604, Box Elder County, Utah       4521    4521    100     2000 UT   
##  7 49003960500 Census Tract 9605, Box Elder County, Utah       4567     435      9.52  2000 UT   
##  8 49003960600 Census Tract 9606, Box Elder County, Utah       6543     182      2.78  2000 UT   
##  9 49003960701 Census Tract 9607.01, Box Elder County, Utah    4396       0      0     2000 UT   
## 10 49003960702 Census Tract 9607.02, Box Elder County, Utah    2225       0      0     2000 UT   
## # … with 486 more rows
## 
## [[4]]
## # A tibble: 588 x 7
##    GEOID       NAME                                     P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 49011125805 Census Tract 1258.05, Davis County, Utah    6167       0         0  2010 UT   
##  2 49011125301 Census Tract 1253.01, Davis County, Utah    5108       0         0  2010 UT   
##  3 49011125305 Census Tract 1253.05, Davis County, Utah    6152       0         0  2010 UT   
##  4 49011125702 Census Tract 1257.02, Davis County, Utah    3839       0         0  2010 UT   
##  5 49011125801 Census Tract 1258.01, Davis County, Utah    6703       0         0  2010 UT   
##  6 49011125804 Census Tract 1258.04, Davis County, Utah    6377       0         0  2010 UT   
##  7 49011125807 Census Tract 1258.07, Davis County, Utah    3114       0         0  2010 UT   
##  8 49011125808 Census Tract 1258.08, Davis County, Utah    5616       0         0  2010 UT   
##  9 49011125905 Census Tract 1259.05, Davis County, Utah    6156       0         0  2010 UT   
## 10 49011125906 Census Tract 1259.06, Davis County, Utah    6987       0         0  2010 UT   
## # … with 578 more rows</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="advanced-data-retrieval.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses the ```pluck``` function to extract the Colorado/2010 dataset from &quot;population_rural_CO_UT_2000_2010_list&quot; </span></span>
<span id="cb188-2"><a href="advanced-data-retrieval.html#cb188-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_2000_2010_list <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,249 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,239 more rows</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="advanced-data-retrieval.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates a name vector in which the four different state/year combinations are connected by an underscore (&quot;_&quot;) and assigns the resulting vector to an object named &quot;name_vector&quot;</span></span>
<span id="cb190-2"><a href="advanced-data-retrieval.html#cb190-2" aria-hidden="true" tabindex="-1"></a>name_vector<span class="ot">&lt;-</span><span class="fu">paste0</span>(my_states, <span class="st">&quot;_&quot;</span>, my_years)</span>
<span id="cb190-3"><a href="advanced-data-retrieval.html#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="advanced-data-retrieval.html#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints &quot;name_vector&quot; to inspect contents</span></span>
<span id="cb190-5"><a href="advanced-data-retrieval.html#cb190-5" aria-hidden="true" tabindex="-1"></a>name_vector</span></code></pre></div>
<pre><code>## [1] &quot;CO_2000&quot; &quot;CO_2010&quot; &quot;UT_2000&quot; &quot;UT_2010&quot;</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="advanced-data-retrieval.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigns the names in &quot;name_vector&quot; to the list elements</span></span>
<span id="cb192-2"><a href="advanced-data-retrieval.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(population_rural_CO_UT_2000_2010_list)<span class="ot">&lt;-</span>name_vector</span>
<span id="cb192-3"><a href="advanced-data-retrieval.html#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="advanced-data-retrieval.html#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints the contents of &quot;population_rural_CO_UT_2000_2010_list&quot;; note that the list elements are now named according to the state/year inputs upon which they are based</span></span>
<span id="cb192-5"><a href="advanced-data-retrieval.html#cb192-5" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_2000_2010_list</span></code></pre></div>
<pre><code>## $CO_2000
## # A tibble: 1,062 x 7
##    GEOID       NAME                                       P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08001007800 Census Tract 78, Adams County, Colorado       8378       0      0     2000 CO   
##  2 08001007900 Census Tract 79, Adams County, Colorado       6617       0      0     2000 CO   
##  3 08001008000 Census Tract 80, Adams County, Colorado       6183       0      0     2000 CO   
##  4 08001008100 Census Tract 81, Adams County, Colorado       1050       0      0     2000 CO   
##  5 08001008200 Census Tract 82, Adams County, Colorado       5393       0      0     2000 CO   
##  6 08001008308 Census Tract 83.08, Adams County, Colorado    4972       0      0     2000 CO   
##  7 08001008309 Census Tract 83.09, Adams County, Colorado    3052      50      1.64  2000 CO   
##  8 08001008353 Census Tract 83.53, Adams County, Colorado    4612     174      3.77  2000 CO   
##  9 08001008385 Census Tract 83.85, Adams County, Colorado       0       0    NaN     2000 CO   
## 10 08001008401 Census Tract 84.01, Adams County, Colorado    3261    3261    100     2000 CO   
## # … with 1,052 more rows
## 
## $CO_2010
## # A tibble: 1,249 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,239 more rows
## 
## $UT_2000
## # A tibble: 496 x 7
##    GEOID       NAME                                         P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                          &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 49001100100 Census Tract 1001, Beaver County, Utah          3314    3314    100     2000 UT   
##  2 49001100200 Census Tract 1002, Beaver County, Utah          2691    2691    100     2000 UT   
##  3 49003960100 Census Tract 9601, Box Elder County, Utah       2712    2712    100     2000 UT   
##  4 49003960200 Census Tract 9602, Box Elder County, Utah       6037    4134     68.5   2000 UT   
##  5 49003960300 Census Tract 9603, Box Elder County, Utah       6223     889     14.3   2000 UT   
##  6 49003960400 Census Tract 9604, Box Elder County, Utah       4521    4521    100     2000 UT   
##  7 49003960500 Census Tract 9605, Box Elder County, Utah       4567     435      9.52  2000 UT   
##  8 49003960600 Census Tract 9606, Box Elder County, Utah       6543     182      2.78  2000 UT   
##  9 49003960701 Census Tract 9607.01, Box Elder County, Utah    4396       0      0     2000 UT   
## 10 49003960702 Census Tract 9607.02, Box Elder County, Utah    2225       0      0     2000 UT   
## # … with 486 more rows
## 
## $UT_2010
## # A tibble: 588 x 7
##    GEOID       NAME                                     P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 49011125805 Census Tract 1258.05, Davis County, Utah    6167       0         0  2010 UT   
##  2 49011125301 Census Tract 1253.01, Davis County, Utah    5108       0         0  2010 UT   
##  3 49011125305 Census Tract 1253.05, Davis County, Utah    6152       0         0  2010 UT   
##  4 49011125702 Census Tract 1257.02, Davis County, Utah    3839       0         0  2010 UT   
##  5 49011125801 Census Tract 1258.01, Davis County, Utah    6703       0         0  2010 UT   
##  6 49011125804 Census Tract 1258.04, Davis County, Utah    6377       0         0  2010 UT   
##  7 49011125807 Census Tract 1258.07, Davis County, Utah    3114       0         0  2010 UT   
##  8 49011125808 Census Tract 1258.08, Davis County, Utah    5616       0         0  2010 UT   
##  9 49011125905 Census Tract 1259.05, Davis County, Utah    6156       0         0  2010 UT   
## 10 49011125906 Census Tract 1259.06, Davis County, Utah    6987       0         0  2010 UT   
## # … with 578 more rows</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="advanced-data-retrieval.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses the ```pluck``` function to extract the 2010 Colorado dataset by name</span></span>
<span id="cb194-2"><a href="advanced-data-retrieval.html#cb194-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_2000_2010_list <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&quot;CO_2010&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,249 x 7
##    GEOID       NAME                                          P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08013013602 Census Tract 136.02, Boulder County, Colorado     912     912    100     2010 CO   
##  2 08013013701 Census Tract 137.01, Boulder County, Colorado    6334    5095     80.4   2010 CO   
##  3 08013013702 Census Tract 137.02, Boulder County, Colorado    5952    5952    100     2010 CO   
##  4 08013060600 Census Tract 606, Boulder County, Colorado       5325     231      4.34  2010 CO   
##  5 08013060700 Census Tract 607, Boulder County, Colorado       3091     111      3.59  2010 CO   
##  6 08013060800 Census Tract 608, Boulder County, Colorado       6107     192      3.14  2010 CO   
##  7 08013060900 Census Tract 609, Boulder County, Colorado       4139       0      0     2010 CO   
##  8 08013061300 Census Tract 613, Boulder County, Colorado       3417       0      0     2010 CO   
##  9 08013061400 Census Tract 614, Boulder County, Colorado       3990       0      0     2010 CO   
## 10 08014030000 Census Tract 300, Broomfield County, Colorado    3378       0      0     2010 CO   
## # … with 1,239 more rows</code></pre>
</div>
<div id="retrieving-data-from-multiple-years-for-multiple-states-and-placing-all-of-the-data-into-a-single-data-frame" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Retrieving data from multiple years, for multiple states, and placing all of the data into a single data frame</h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="advanced-data-retrieval.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Applies the &quot;population_rural_statetract_year&quot; function to the inputs specified by the &quot;my_states&quot; and &quot;my_years&quot; vectors, and deposits the resulting four census datasets (CO/2000, CO/2010, UT/2000, UT/2010) into a single data frame assigned to an object named &quot;population_rural_CO_UT_2000_2010_df&quot;</span></span>
<span id="cb196-2"><a href="advanced-data-retrieval.html#cb196-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_2000_2010_df<span class="ot">&lt;-</span><span class="fu">map2_dfr</span>(<span class="at">.x=</span>my_states, <span class="at">.y=</span>my_years, <span class="at">.f=</span>population_rural_statetract_year)</span></code></pre></div>
<pre><code>## Getting data from the 2000 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;08&#39; for state &#39;CO&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;08&#39; for state &#39;CO&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2000 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;49&#39; for state &#39;UT&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<pre><code>## Getting data from the 2010 decennial Census</code></pre>
<pre><code>## Using FIPS code &#39;49&#39; for state &#39;UT&#39;</code></pre>
<pre><code>## Using Census Summary File 1</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="advanced-data-retrieval.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints the contents of &quot;population_rural_CO_UT_2000_2010_df&quot; </span></span>
<span id="cb209-2"><a href="advanced-data-retrieval.html#cb209-2" aria-hidden="true" tabindex="-1"></a>population_rural_CO_UT_2000_2010_df</span></code></pre></div>
<pre><code>## # A tibble: 3,395 x 7
##    GEOID       NAME                                       P001001 P002005 rural_pct  YEAR STATE
##    &lt;chr&gt;       &lt;chr&gt;                                        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1 08001007800 Census Tract 78, Adams County, Colorado       8378       0      0     2000 CO   
##  2 08001007900 Census Tract 79, Adams County, Colorado       6617       0      0     2000 CO   
##  3 08001008000 Census Tract 80, Adams County, Colorado       6183       0      0     2000 CO   
##  4 08001008100 Census Tract 81, Adams County, Colorado       1050       0      0     2000 CO   
##  5 08001008200 Census Tract 82, Adams County, Colorado       5393       0      0     2000 CO   
##  6 08001008308 Census Tract 83.08, Adams County, Colorado    4972       0      0     2000 CO   
##  7 08001008309 Census Tract 83.09, Adams County, Colorado    3052      50      1.64  2000 CO   
##  8 08001008353 Census Tract 83.53, Adams County, Colorado    4612     174      3.77  2000 CO   
##  9 08001008385 Census Tract 83.85, Adams County, Colorado       0       0    NaN     2000 CO   
## 10 08001008401 Census Tract 84.01, Adams County, Colorado    3261    3261    100     2000 CO   
## # … with 3,385 more rows</code></pre>
<p><a href="https://mattherman.info/blog/tidycensus-mult-year/">https://mattherman.info/blog/tidycensus-mult-year/</a></p>
<p>median age by county colorado
vis and map</p>
<p>functions and iteration</p>
<p>advanced retrieval</p>
<p>temporal dynamics</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="functions-and-iteration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="working-with-multiple-datasets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aranganath24/R_Census/edit/master/07-advanced-retrieval.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/aranganath24/R_Census/blob/master/07-advanced-retrieval.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
